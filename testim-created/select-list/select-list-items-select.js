/**
 *  Select List - Items Select
 *
 *      Select an item or multiple items from a listbox, dropdown, multi-select or table.  Optionally can support check list items
 * 
 *  Parameters: 
 * 
 *      element  : Target element (or parent/child of) a <select>, <ol>, <ul>
 * 
 *      itemId   : String and/or Integer index (0-based) of target <option>, <li>, <tr>, <td> or any child of the aforementioned
 *    			  Can be an array for selecting multiple items ["Item 1", "Item 2", 3, 4, 5, 'Random']
 * 
 *      checkState [optional] : Only select item(s) if not checked/selected		
 *		    Examples: 	true    - Check
 *            			false   - Uncheck
 *                      <unset> - Toggle
 *                      <user-defined> - allows for option state interrogation            		
 *                    		"className === 'selected'"
 *		    		 		"querySelector(\"input[type='checkbox']\").checked"
 *		    		 		"getAttribute('aria-checked') === 'true'"
 *                          'classList.contains("x-menu-item-checked")'
 * 
 *      clickToOpen (JS) [optional] : If select is triggered by an action then element is the trigger. Default (false)
 *
 *      matchType [optional] : Text match type when searching for text in lists/selects
 *		    Examples: exact, startswith, endswith, includes (default)
 *
 *      highlightElements (JS) [optional] : Highlight Target Grid, Header, RowGroup, Cells for posterity (and debugging)
 *
 *      highlightDuration (JS) [optional] : Time to highlight item(s)
 *
 *  Returns
 *      selectedIndex
 *      selectedText
 *      selectedValue
 *
 *  Version       Date          Author            Details
 *      3.2.1     10/15/2024    Barry Solomon     Support popup x-menu and figure out target state.  (P&G Exclusive, though I have code in select-find.js, but not deployed anywhere else)
 *      3.3.1     10/23/2024    Barry Solomon     Add support for "blDashboardList" custom list
 *      3.3.2     10/23/2024    Barry Solomon     Default click_to_open = false
 *
 *  Disclaimer
 *      This Custom Action is provided "AS IS".  It is for instructional purposes only and is not officially supported by Testim
 *
 *  Base Step
 *      Custom Action
 * 
**/

var verbose = false;

/*** START COMMON LIST FUNCTIONALITY ***/

/* User setable parameters (do not change without understanding what these are for) 
 */
var return_variable_name = undefined;
var return_type = 'STRING';
var result_filter = "All";
var result_regex = null;
var target_state = undefined;
var popup_timeout = 2000;

var click_to_open = false;
if (typeof clickToOpen !== 'undefined' && clickToOpen !== null)
    click_to_open = clickToOpen;

var match_type = 'exact';
if (typeof matchType !== 'undefined' && matchType !== null)
    match_type = matchType;

var DEFAULT_RETURN_VARIABLE_NAME = 'actualItems';

var results = null;
var select_list_tagname = null;
var select_list = null;
var select_list_opener = null;
var select_listitem_groupbox = null;
var selected_item_indexes = [];
var unselected_item_indexes = null;

/*** LIST FUNCTIONS v3.3.1 ***/
const g=A;(function(h,Q){const j=A,v=h();while(!![]){try{const Y=parseInt(j(0x13c))/0x1+-parseInt(j(0x12a))/0x2*(parseInt(j(0x1c3))/0x3)+parseInt(j(0x13f))/0x4+-parseInt(j(0x137))/0x5*(-parseInt(j(0x197))/0x6)+-parseInt(j(0x18b))/0x7*(-parseInt(j(0x19b))/0x8)+parseInt(j(0x168))/0x9*(parseInt(j(0x1cd))/0xa)+parseInt(j(0x1d8))/0xb*(-parseInt(j(0x1de))/0xc);if(Y===Q)break;else v['push'](v['shift']());}catch(m){v['push'](v['shift']());}}}(y,0xced6e));var DEFAULT_RETURN_VARIABLE_NAME=g(0x172),DEFAULT_HIGHLIGHT_DURATION=0x1388,highlight_duration=DEFAULT_HIGHLIGHT_DURATION;typeof highlightDuration!=='undefined'&&highlightDuration!==null&&(highlight_duration=highlightDuration);var clickEventMethod=g(0x157),popupTimeout=0x7d0,selectItemTimeout=0x7d0,highlight_elements=![],highlight_select_item=![],highlight_groupbox=![],highlight_selectlist=![],highlight_selectlist_opener=![],LIST_HIGHLIGHT_BORDER=g(0x1d7),LIST_OPENER_HIGHLIGHT_BORDER=g(0x1da),LIST_GROUPBOX_HIGHLIGHT_BORDER=g(0x1d7),LIST_ITEM_SELECTED_HIGHLIGHT_BORDER=g(0x1b0),current_list_selector=null,current_list_opener_selector=null,current_listitem_groupbox_selector=null,current_listitem_selector=null;const valid_container_tags=[g(0x142),'ol','ul',g(0x145),g(0x1c4)],valid_item_tags=[g(0x1a7),'li'];var custom_list_selectors=[{'name':g(0x177),'custom_list_selector':{'tagName':g(0x175),'querySelector':'bl-dashboard-lists-container'},'custom_listitem_groupbox_selector':{'tagName':'bl-dashboard-lists-view','querySelector':g(0x1ba)},'custom_listitem_selector':{'tagName':g(0x1c2),'querySelector':g(0x1c2),'targetClickXPath':g(0x146)}},{'name':g(0x1aa),'custom_list_selector':{'tagName':g(0x142),'querySelector':g(0x142)},'custom_listitem_selector':{'tagName':'option','querySelector':'option'}},{'name':'unorderedList','custom_list_selector':{'tagName':'ul','querySelector':'ul'},'custom_listitem_selector':{'tagName':'li','querySelector':'li'}},{'name':g(0x134),'custom_list_selector':{'tagName':'ol','querySelector':'ol'},'custom_listitem_selector':{'tagName':'li','querySelector':'li'}},{'name':g(0x15a),'custom_list_selector':{'tagName':g(0x127),'attributeName':g(0x1a3),'attributeValue':g(0x1c0),'querySelector':g(0x1b4)},'custom_listitem_selector':{'tagName':g(0x133),'querySelector':g(0x135)}},{'name':'pullRightAnchor','custom_list_selector':{'tagName':g(0x118),'attributeName':g(0x1a3),'attributeValue':g(0x130),'querySelector':g(0x15c)},'custom_listitem_selector':{'tagName':'a','querySelector':'a'}},{'name':g(0x12f),'custom_list_selector':{'tagName':'span','attributeName':'role','attributeValue':g(0x141),'querySelector':g(0x11f)},'custom_listitem_groupbox_selector':{'display':g(0x1ad),'parentElement':document,'selectListLinkAttribute':g(0x17f),'tagName':'ul','querySelector':g(0x12c)},'custom_listitem_selector':{'tagName':'li','querySelector':'li'}},{'name':g(0x14e),'custom_list_selector':{'tagName':g(0x118),'attributeName':'role','attributeValue':g(0x18e),'querySelector':g(0x14a)},'custom_listitem_selector':{'tagName':g(0x118),'attributeName':g(0x123),'attributeValue':g(0x182),'querySelector':g(0x125)}},{'name':g(0x181),'custom_list_selector':{'tagName':'div','attributeName':g(0x123),'attributeValue':g(0x1cb),'querySelector':g(0x1c1)},'custom_listitem_selector':{'tagName':g(0x118),'attributeName':g(0x123),'attributeValue':g(0x1a7),'querySelector':g(0x189)}},{'name':'resultsContainerItem','custom_list_selector':{'tagName':g(0x118),'attributeName':'class','attributeValue':'o-resultsContainer','querySelector':g(0x12e)},'custom_listitem_selector':{'tagName':'a','attributeName':'class','attributeValue':g(0x159),'querySelector':g(0x16f)}},{'name':g(0x1b1),'custom_list_selector':{'tagName':g(0x118),'attributeName':g(0x196),'attributeValue':g(0x1b5),'querySelector':g(0x161),'openerSelector':g(0x13b)},'custom_listitem_groupbox_selector':{'tagName':'ul','querySelector':'ul','display':g(0x1ad)},'custom_listitem_selector':{'tagName':'li','querySelector':'li'}},{'name':g(0x1c8),'custom_list_selector':{'tagName':g(0x118),'attributeName':g(0x123),'attributeValue':'menu','querySelector':g(0x148)},'custom_listitem_selector':{'tagName':'li','querySelector':'li'}},{'name':g(0x131),'custom_list_selector':{'tagName':g(0x118),'attributeName':g(0x123),'attributeValue':'menu','querySelector':'div[role=\x22menu\x22]'},'custom_listitem_selector':{'tagName':g(0x118),'attributeName':g(0x123),'attributeValue':g(0x1ac),'querySelector':'div[role=\x22menuitemcheckbox\x22]'}},{'name':g(0x117),'custom_list_selector':{'tagName':g(0x118),'attributeName':g(0x1a3),'attributeValue':g(0x1cf),'querySelector':g(0x1a0)},'custom_listitem_selector':{'tagName':g(0x118),'attributeName':g(0x123),'attributeValue':'menuitemcheckbox','querySelector':g(0x15f)}},{'name':g(0x193),'custom_list_selector':{'tagName':'span','attributeName':g(0x1a3),'attributeValue':g(0x140),'querySelector':g(0x150)}},{'name':'menuListItemIcon','custom_list_selector':{'tagName':g(0x118),'attributeName':g(0x1a3),'attributeValue':g(0x124),'querySelector':g(0x112)}},{'name':g(0x1a9),'custom_list_selector':{'tagName':g(0x118),'attributeName':g(0x123),'attributeValue':g(0x1bc),'querySelector':g(0x148)},'custom_listitem_selector':{'tagName':g(0x118),'attributeName':g(0x1a3),'attributeValue':g(0x1a6),'querySelector':g(0x15e)}}];function elementMatchesCustomSelector(h,Q){const D=g;if(h?.[D(0x188)]['toLowerCase']()===Q[D(0x188)][D(0x121)]()){if(Q[D(0x1d0)]&&Q[D(0x1dc)])return h[D(0x14c)](Q[D(0x1d0)])===Q[D(0x1dc)];return!![];}return![];}function selectListFind(h,Q=custom_list_selectors){const T=g;let v=h,Y=v?.[T(0x188)][T(0x121)](),m=[];[T(0x142),'ul','ol'][T(0x1ae)](Y)&&Q[T(0x173)](u=>{const M=T;elementMatchesCustomSelector(v,u[M(0x1dd)])&&(Y=v?.[M(0x188)][M(0x121)](),u[M(0x1d4)]=v,m[M(0x158)](u));});!valid_container_tags[T(0x1ae)](Y)&&(v=h?.[T(0x165)](T(0x142))[0x0]||h?.['getElementsByTagName']('ul')[0x0]||h?.[T(0x165)]('ol')[0x0],v?Q['forEach'](u=>{const X=T;elementMatchesCustomSelector(v,u[X(0x1dd)])&&(Y=v?.[X(0x188)][X(0x121)](),u[X(0x1d4)]=v,m['push'](u));}):Q[T(0x173)](u=>{const z=T;elementMatchesCustomSelector(h,u[z(0x1dd)])&&(u[z(0x1d4)]=v,m[z(0x158)](u));}),!v&&Q['forEach'](u=>{const Z=T;!v&&(v=h[Z(0x1af)](u[Z(0x1dd)]['querySelector']),!v&&(v=h[Z(0x13a)][Z(0x1af)](u[Z(0x1dd)][Z(0x1af)])),v&&(Y=Z(0x1c4),u[Z(0x1d4)]=v,m[Z(0x158)](u)));}));if(!valid_container_tags[T(0x1ae)](Y)){v=h;while(!valid_container_tags['includes'](Y)&&v){v=v[T(0x13a)],Y=(v?.[T(0x188)]||'')[T(0x121)](),Q[T(0x173)](u=>{const R=T;Y===u['custom_list_selector']?.[R(0x188)]&&(u[R(0x1dd)][R(0x1d0)]&&u[R(0x1dd)]['attributeValue']?v['getAttribute'](u[R(0x1dd)][R(0x1d0)])===u[R(0x1dd)][R(0x1dc)]&&(u['select_list_instance']=v,m[R(0x158)](u)):(u['select_list_instance']=v,m[R(0x158)](u)));});}}let H=selectBestMatch(m,h);if(H){current_list=H['select_list_instance'],current_match=H,current_listitem_selector=H[T(0x154)],current_listitem_groupbox_selector=H[T(0x164)];switch(H['name']){case T(0x1aa):Y=T(0x142);break;case T(0x17c):Y='ul';break;case'orderedList':Y='ol';break;default:Y=T(0x1c4);break;}return{'best_match':H,'select_list':current_list,'select_list_opener':current_list_selector?.[T(0x1db)]?v[T(0x1af)](current_list_selector[T(0x1db)]):v,'select_listitem_groupbox':current_listitem_groupbox_selector?v['querySelector'](current_listitem_groupbox_selector[T(0x1af)]):null,'select_list_tagname':Y};}else return console['error']('Select\x20Option(s)\x20==>\x20Target\x20element\x20must\x20be\x20a\x20select,\x20ol,\x20ul,\x20or\x20custom\x20container.'),null;}function findBestSelectList(h){return selectListFind(h);}function isElementMatching(h,Q){const q=g;if(!h||!Q)return![];let v=!![];Q[q(0x1dd)]?.[q(0x188)]&&(v=v&&h?.['tagName']['toLowerCase']()===Q[q(0x1dd)][q(0x188)]['toLowerCase']());if(Q[q(0x1dd)]?.['querySelector']){const Y=h['matches'](Q[q(0x1dd)][q(0x1af)]);v=v&&Y;}Q[q(0x1dd)]?.[q(0x143)]&&Object[q(0x1d2)](Q[q(0x1dd)][q(0x143)])[q(0x173)](m=>{const r=q,H=Q[r(0x1dd)]['attributes'][m],u=h['getAttribute'](m);H!==u&&(v=![]);});if(Q[q(0x1dd)]?.[q(0x123)]){const m=h[q(0x14c)]('role');v=v&&m===Q[q(0x1dd)][q(0x123)];}if(Q['custom_listitem_selector']?.['querySelector']){const H=h[q(0x19c)](Q[q(0x154)][q(0x1af)]);H['length']===0x0&&(v=![]);}return v;}function selectBestMatch(h){const t=g;if(h[t(0x17d)]===0x0)return null;let Q=null,v=0x0;return h[t(0x173)](Y=>{const k=t;let m=0x1;const H=isElementMatching(Y?.['select_list_instance'],Y);if(H&&Y[k(0x1dd)])m++;if(H&&Y['custom_listitem_selector'])m++;if(H&&Y[k(0x164)])m++;if(H&&Y['custom_listitem_selector']?.[k(0x1af)]){const u=Y?.['select_list_instance'][k(0x19c)](Y[k(0x154)]['querySelector']);u[k(0x17d)]>0x0&&(m+=u[k(0x17d)]);}m>v&&(v=m,Q=Y);}),Q;}function selectListItemsGet(h,Q){const S=g;let v=h[S(0x116)]??h,Y=[],m=[];switch(h['select_list_tagname']){case S(0x142):m=v[S(0x19f)];break;case'ul':case'ol':m=v[S(0x165)]('li');break;case S(0x1c4):default:m=v[S(0x19c)](current_listitem_selector?.['querySelector']);break;}console['log'](S(0x1be),m['length']);let H=null;for(let u=0x0;u<m[S(0x17d)];u++){switch(select_list_tagname){case'select':switch(Q){case S(0x1ab):H={'index':u,'text':m[u][S(0x1d5)],'value':m[u]['value']};break;case S(0x114):H=m[u]['value'];break;case S(0x120):case'STRING':H=m[u][S(0x1d5)];break;default:H={'index':u,'text':m[u][S(0x1d5)]},H[Q]=m[u][S(0x143)][Q][S(0x1b2)];break;}break;case'ul':case'ol':switch(Q){case S(0x1ab):H={'index':u,'text':m[u][S(0x139)]};break;case'VALUE':H=m[u][S(0x1b2)];break;case S(0x120):case'STRING':H=m[u][S(0x139)];break;default:H={'index':u,'text':m[u]['textContent']},H[Q]=m[u][S(0x143)][Q][S(0x1b2)];break;}break;case S(0x1c4):switch(Q){case S(0x1ab):H={'index':u,'innerHTML':m[u]['innerHTML']};break;case S(0x114):H=m[u]['value'];break;case S(0x120):case S(0x1b8):H=m[u][S(0x139)];break;default:H={'index':u,'text':m[u][S(0x139)]},H[Q]=m[u]['attributes'][Q][S(0x1b2)];break;}break;}if(H!==null)Y['push'](H);}return Y;}function contains(h,Q){let v=document['querySelectorAll'](h);return Array['prototype']['filter']['call'](v,function(Y){const K=A;return RegExp(Q)[K(0x13e)](Y[K(0x139)]);});}function highlightElement(h,Q,v=highlight_duration){const W=g;if(!h)return;const Y=h[W(0x1c7)][W(0x163)];(Q!==LIST_ITEM_SELECTED_HIGHLIGHT_BORDER||Y===LIST_HIGHLIGHT_BORDER)&&(h[W(0x1c7)][W(0x163)]=Q,setTimeout(()=>{const B=W;h['style'][B(0x163)]=Y;},v));}function selectListItemsGet(h,Q){const i=g;let v=[],Y=null;switch(select_list_tagname){case'select':Y=h['options'];break;case'ul':case'ol':Y=h[i(0x165)]('li');break;case i(0x1c4):Y=h[i(0x19c)](current_listitem_selector?.[i(0x1af)]);break;}console[i(0x186)](i(0x1be),Y[i(0x17d)]);let m=null;for(let H=0x0;H<Y[i(0x17d)];H++){switch(select_list_tagname){case'select':switch(Q){case'ITEM':m={'index':H,'text':Y[H][i(0x1d5)],'value':Y[H]['value']};break;case i(0x114):m=Y[H][i(0x1b2)];break;case i(0x120):case i(0x1b8):m=Y[H]['text'];break;default:m={'index':H,'text':Y[H][i(0x1d5)]},m[Q]=Y[H][i(0x143)][Q]['value'];break;}break;case'ul':case'ol':switch(Q){case i(0x1ab):m={'index':H,'text':Y[H][i(0x139)]};break;case'VALUE':m=Y[H][i(0x1b2)];break;case'TEXT':case'STRING':m=Y[H][i(0x139)];break;default:m={'index':H,'text':Y[H]['textContent']},m[Q]=Y[H][i(0x143)][Q][i(0x1b2)];break;}break;case'custom':switch(Q){case i(0x1ab):m={'index':H,'innerHTML':Y[H]['innerHTML']};break;case i(0x114):m=Y[H][i(0x1b2)];break;case'TEXT':case i(0x1b8):m=Y[H][i(0x139)];break;default:m={'index':H,'text':Y[H][i(0x139)]},m[Q]=Y[H][i(0x143)][Q][i(0x1b2)];break;}break;}if(m!==null)v[i(0x158)](m);}return v;}function selectListItemsFilter(h){const c=g;let Q=null;switch(result_filter){case c(0x187):Q=h[0x0];break;case c(0x192):Q=h[h[c(0x17d)]-0x1];break;default:if(isNaN(result_filter))Q=h;else Q=result_filter<0x0?h[c(0x17a)](result_filter):h[c(0x17a)](0x0,result_filter);break;}return typeof result_regex!==c(0x184)&&result_regex!==null&&[c(0x120),c(0x1b8)][c(0x1ae)](return_type)&&(result_regex=resultRegex,Q['forEach']((v,Y)=>{const I=c;let m=new RegExp(result_regex),H=v[I(0x195)](m);H!==null&&(Q[Y]=H[0x0]);})),Q;}function validateSelectOptionOrder(h,Q){const C=g;if(typeof h===C(0x184)||h===null||h['length']===0x0)throw new Error('resultValues\x20list\x20not\x20found');let v=[];for(let m=0x0;m<h[C(0x17d)];m++){v[C(0x158)](h[m]);}let Y=[...v];if(Q===C(0x18c))Y[C(0x180)]()[C(0x1a1)]();else Y[C(0x180)]();console[C(0x186)](C(0x160)+JSON[C(0x17e)](Y)),console[C(0x186)](C(0x1a4)+JSON[C(0x17e)](v));if(Y[C(0x1b3)](function(H,u){return H===v[u];})===![])throw new Error(C(0x147)+Q+'\x20Actual\x20Order:\x20'+JSON['stringify'](v,null,0x2)+C(0x153)+JSON[C(0x17e)](Y,null,0x2));}function validateItems(h,Q,v){const l=g;let Y=!![],m,H,u=[];for(let V=0x0;V<Q[l(0x17d)];V++){m=Q[V];let n=Object[l(0x1d2)](m)[l(0x1ae)](l(0x128))?m[l(0x128)]:V;H=h?.[l(0x17d)]>=h&&h[n]!==null?h[n]:undefined;if(typeof m===l(0x194)){Y=![],h[l(0x173)](F=>{if(stringMatch[v](F,m)){if(!Y)Y=!![];}});if(!Y)u[l(0x158)]({'Expected':m,'MatchType':v});}}if(u?.[l(0x17d)]>0x0){verbose&&(console[l(0x186)](l(0x190),JSON[l(0x17e)](Q)),console[l(0x186)](l(0x15b),JSON[l(0x17e)](H)));console['log'](l(0x11b),JSON[l(0x17e)](u,null,0x2));throw new Error(l(0x119)+JSON[l(0x17e)](u,null,0x2));}return Y;}function getSelectedOptions(h){const U=g;var Q=[],v=[],Y=[];switch(element_type){case'select':default:for(var m=0x0,H=h[U(0x19f)]['length'];m<H;m++){let u=h[U(0x19f)][m];Q[U(0x158)]({'text':u['text'],'value':u[U(0x1b2)],'index':m}),u[U(0x1d9)]&&(v['push']({'text':u[U(0x1d5)],'value':u['value'],'index':m}),expected_values?.[U(0x17d)]>0x0&&expected_values[U(0x122)](V=>{const a=U;return stringMatch[match_type](u?.['text'],V?.[a(0x1d5)])||stringMatch[match_type](u?.[a(0x1b2)],V?.['value']);})&&Y[U(0x158)]({'text':u['text'],'value':u['value'],'index':m}));}break;}return{'options':Q,'selected_options':v,'selected_options_matched':Y};}function y(){const ym=['DESCENDING','No\x20valid\x20observer\x20target\x20found','list','ul\x20>\x20li,\x20ol\x20>\x20li','expected_value','appendChild','last','menuListText','string','match','data-react-toolbox','95226VFEGZF','custom_list_selectors','target','Select\x20Option(s)\x20==>\x20Target\x20element\x20must\x20be\x20a\x20select,\x20ol,\x20ul,\x20or\x20custom\x20container.','570584lSIIvI','querySelectorAll','offsetParent','removeChild','options','div[class*=\x22x-menu-body\x22]','reverse','notstartswith','class','Actual\x20Item\x20Order:\x20\x20\x20','querySelector(\x22input[type=\x27checkbox\x27]\x22).checked\x20===\x20false','x-menu-item','option','targetClickXPath','xMenu','standardSelect','ITEM','menuitemcheckbox','hidden','includes','querySelector','2px\x20solid\x20Red','dropdownUl','value','every','fieldset[class=\x22cx-fieldset\x22]','dropdown','nodeType','endsWith','STRING','type','bl-dashboard-lists-view','COMING\x20SOON','menu','startswith','items.length','Target\x20List/Select\x20element\x20is\x20undefined','cx-fieldset','div[role=\x22listbox\x22]','bl-dashboard-list','6CgtPSx','custom','info','notcontains','style','menuListItem','copy','startsWith','listbox','All','10kDEBsA','return_type','x-menu-body','attributeName','readonly','keys','FIRST_ORDERED_NODE_TYPE','select_list_instance','text','name','2px\x20solid\x20Green','3773GHyTKB','selected','2px\x20dashed\x20Green','openerSelector','attributeValue','custom_list_selector','101580hcJSac','exact','then','div[class*=\x22x-menu-item-icon\x22]','product-set','VALUE','simulated','select_list','menuListBody','div','SelectList\x20Items\x20Validate\x20-\x20Not\x20Found:\x0a','change','SelectList\x20Items\x20Validate\x20-\x20Not\x20Found:\x20','getSelection','ASCENDING','result_filter','span[role=\x22combobox\x22]','TEXT','toLowerCase','some','role','x-menu-item-icon','div[role=\x22listitem\x22]','removeAllRanges','fieldset','index','Space','1258996tjFGMI','filter','#categories_listbox','singleNodeValue','.o-resultsContainer','comboboxList','pull-right','menuList','items[target_item_index].','label','orderedList','label[class*=\x22cx-checkbox\x22]','execCommand','455FdQZfS','regex','textContent','parentNode','input','1058183cTvmUs','random','test','3023308kpzlWm','x-menu-item-text','combobox','select','attributes','Failed\x20to\x20evaluate\x20XPath:','table','.//div[contains(@class,\x20\x27drop-down__target\x27)]','Options\x20are\x20not\x20in\x20','div[role=\x22menu\x22]','body','div[role=\x22list\x22]','mouseover','getAttribute','createElement','divRoleList','rangeCount','span[class*=\x22x-menu-item-text\x22]','keyup','keypress','\x20Expected\x20Order:\x20','custom_listitem_selector','executeActionWithXPath:err','dispatchEvent','simulateFullClick','push','o-item','cxFieldsetCheckbox','actual_value','.pull-right','href','div[class*=\x22x-menu-item\x22]','div[role=\x22menuitemcheckbox\x22]','Expected\x20Item\x20Order:\x20','div[data-react-toolbox=\x22dropdown\x22]','best_match','border','custom_listitem_groupbox_selector','getElementsByTagName','Timeout\x20reached\x20without\x20detecting\x20visibility\x20or\x20new\x20element.','observe','15120999PrsVKy','floor','splice','click','getRangeAt','hover','setAttribute','a.o-item','querySelector(\x22input[type=\x27checkbox\x27]\x22).checked\x20===\x20true','No\x20valid\x20target\x20element\x20found','actualItems','forEach','disconnect','bl-dashboard-lists-container','toUpperCase','blDashboardList','object','error','slice','join','unorderedList','length','stringify','aria-controls','sort','listboxOptionDiv','listitem','endswith','undefined','is_selected','log','first','tagName','div[role=\x22option\x22]','keydown','7KzzAmn'];y=function(){return ym;};return y();}function findFirstClickableChild(h){const p=g,Q=['a'],v=h['querySelectorAll'](Q[p(0x17b)](',\x20'));return v[0x0]||null;}function A(h,Q){const v=y();return A=function(Y,m){Y=Y-0x110;let H=v[Y];return H;},A(h,Q);}function selectItem(h,Q,v,Y){const w=g;let m=-0x1,H=[];switch(v){case'ol':case'ul':H=h[w(0x19c)](w(0x18f));if(typeof Q===w(0x194)&&Q['toLowerCase']()===w(0x13d)){let V=[...h[w(0x19c)]('ul\x20>\x20li,\x20ol\x20>\x20li')];H=V[w(0x12b)](n=>{const s=w;try{let F=n[s(0x14c)](s(0x15d)),E=n[s(0x1af)]('.cx-productcard-snipe-label')['innerText'][s(0x176)]();return!(F?.[s(0x1ae)](s(0x113))||E?.[s(0x1ae)](s(0x1bb)));}catch(L){return![];}});}break;case'custom':H=h[w(0x19c)](current_listitem_selector?.[w(0x1af)]);break;case'select':default:H=h[w(0x19f)];break;}switch(typeof Q){case'number':m=Q;if(m>=H['length'])m=H['length'];if(H['length']<=0x0)return![];break;case'string':default:if(Q['toLowerCase']()==w(0x13d)){unselected_item_indexes===null&&H['length']>0x0&&(unselected_item_indexes=[],H[w(0x173)]((n,F)=>{const e=w;unselected_item_indexes[e(0x158)](F);}));m=unselected_item_indexes[Math[w(0x169)](Math['random']()*unselected_item_indexes[w(0x17d)])],selected_item_indexes[w(0x158)](m);break;}for(let n=0x0;n<H[w(0x17d)];n++){switch(v){case'select':(stringMatch[Y](h['options'][n][w(0x1d5)][w(0x121)](),Q[w(0x121)]())||h['options'][n]['value']['toLowerCase']()===Q[w(0x121)]())&&(m=n);break;case'ol':case'ul':default:stringMatch[Y](H[n][w(0x139)]['toLowerCase'](),Q['toLowerCase']())&&(m=n);break;}if(m>=0x0)break;}break;}if(m>=0x0){selected_item_indexes[w(0x158)](m);if(unselected_item_indexes!==null)unselected_item_indexes[w(0x16a)](m,0x1);let F=![],E;switch(v){case w(0x142):if(highlight_elements&&highlight_select_item&&h[w(0x19f)][m]!==null)highlightElement(h[w(0x19f)][m],LIST_ITEM_SELECTED_HIGHLIGHT_BORDER);typeof checkState!=='undefined'&&checkState!=null?(E=checkState,console[w(0x186)](w(0x185),F)):E=!h[w(0x19f)][m][w(0x1d9)];try{h['options'][m][w(0x1d9)]!=E&&(h['options'][m][w(0x1d9)]=E,h[w(0x19f)][m][w(0x16b)]());}catch(L){h[w(0x19f)][m][w(0x1d9)]=E;}h['dispatchEvent'](new Event(w(0x11a)));return!![];case'ol':case'ul':default:if(highlight_elements&&highlight_select_item&&H[m]!==null)highlightElement(H[m],LIST_ITEM_SELECTED_HIGHLIGHT_BORDER);typeof target_state!==w(0x184)&&(F=eval('('+w(0x132)+target_state+')'),console['log'](w(0x185),F));if(!F){var u=current_match?.['custom_listitem_selector']?.[w(0x1a8)]??'.//input';return new Promise((P,o)=>{const b=w;executeActionWithXPath({'clickMethod':clickEventMethod,'targetSelector':H[m],'targetElementXPath':u,'observerTarget':null,'timeoutDuration':selectItemTimeout,'useTimeout':!![]})[b(0x111)](x=>{const O=b;console[O(0x186)](x),P(x);})['catch'](x=>{console['error'](x),o(x);});});}return!![];}}return![];}function handleEventsPlaceholder(h){const y0=g;if(!h)throw new Error('Target\x20element\x20is\x20undefined\x20or\x20null');try{var Q=new Event(y0(0x16d),{'bubbles':!![],'composed':!![]});Q[y0(0x115)]=!![],h['dispatchEvent'](Q);var v=new KeyboardEvent(y0(0x18a),{'key':'\x20','code':'Space','keyCode':0x20,'charCode':0x20,'bubbles':!![],'composed':!![]});h[y0(0x156)](v);var Y=new KeyboardEvent(y0(0x152),{'key':'\x20','code':y0(0x129),'keyCode':0x20,'charCode':0x20,'bubbles':!![],'composed':!![]});h[y0(0x156)](Y);var m=new KeyboardEvent(y0(0x151),{'key':'\x20','code':y0(0x129),'keyCode':0x20,'charCode':0x20,'bubbles':!![],'composed':!![]});h['dispatchEvent'](m);var H=new Event(y0(0x16b),{'bubbles':!![],'composed':!![]});H[y0(0x115)]=!![],h['dispatchEvent'](H);var u=new Event(y0(0x11a),{'bubbles':!![],'composed':!![]});u[y0(0x115)]=!![],h['dispatchEvent'](u);}catch(V){console[y0(0x179)](V);throw V;}}function simulateFullClick(h){const y1=g;try{const Q=[y1(0x14b),'mousedown','mouseup',y1(0x16b)];Q['forEach'](v=>{const Y=new MouseEvent(v,{'bubbles':!![],'composed':!![],'cancelable':!![],'view':window});h['dispatchEvent'](Y);});}catch(v){reject(v);}}function executeActionWithXPath({clickMethod:clickMethod=clickEventMethod,targetSelector:h,targetElementXPath:targetElementXPath=null,observerTarget:Q,timeoutDuration:timeoutDuration=0x7d0,useTimeout:useTimeout=!![]}){return new Promise((v,Y)=>{const y5=A;if(Q!==null){const u=new MutationObserver((n,F)=>{const y2=A;var E=[];n[y2(0x173)](P=>{const y3=y2;select_list=null;if(P[y3(0x1b9)]===y3(0x143)){var o=P[y3(0x199)],x=o['offsetParent']!==null;if(x)try{select_list=selectListFind(o),select_list&&(!E['some'](N=>N===select_list[y3(0x162)])&&E['push'](select_list[y3(0x162)]));}catch(N){console[y3(0x179)](y3(0x155),N);}}P[y3(0x1b9)]==='childList'&&P['addedNodes']['forEach'](G=>{const y4=y3;if(G[y4(0x1b6)]===0x1){const J=G[y4(0x19d)]!==null;if(J){var f=G;try{select_list=selectListFind(f),select_list&&(!E[y4(0x122)](d=>d===select_list[y4(0x162)])&&E[y4(0x158)](select_list[y4(0x162)]));}catch(d){console[y4(0x179)](y4(0x155),d);}}}});});let L=selectBestMatch(E);if(L){current_list=L[y2(0x1d4)],current_list_selector=L['custom_list_selector'],current_listitem_selector=L[y2(0x154)],current_listitem_groupbox_selector=L['custom_listitem_groupbox_selector'];switch(L[y2(0x1d6)]){case y2(0x1aa):select_list_tagname=y2(0x142);break;case y2(0x17c):select_list_tagname='ul';break;case y2(0x134):select_list_tagname='ol';break;default:select_list_tagname=y2(0x1c4);break;}F[y2(0x174)](),v(L);}else return console[y2(0x179)](y2(0x19a)),null;});let V=typeof Q===y5(0x194)?document[y5(0x1af)](Q):Q;if(V)u[y5(0x167)](V,{'attributes':!![],'childList':!![],'subtree':!![]});else{Y(new Error(y5(0x18d)));return;}}function m(n,F){const y6=y5;if(!n){Y(new Error('Target\x20element\x20is\x20undefined\x20or\x20null'));return;}try{if(F===y6(0x157))simulateFullClick(n);else{if(F===y6(0x156))m(n);else F===y6(0x16b)&&n[y6(0x16b)]();}}catch(E){Y(E);}}let H=typeof h===y5(0x194)?document[y5(0x1af)](h):h;if(H&&targetElementXPath)try{const n=document['evaluate'](targetElementXPath,H,null,XPathResult[y5(0x1d3)],null)[y5(0x12d)];n&&(H=n);}catch(F){console['error'](y5(0x144),F);}if(!H){Y(new Error(y5(0x171)));return;}if(highlight_elements&&highlight_select_item&&H!==null)highlightElement(H,LIST_ITEM_SELECTED_HIGHLIGHT_BORDER);m(H,clickMethod);if(useTimeout)setTimeout(()=>{const y7=y5;Y(new Error(y7(0x166)));},timeoutDuration);else clickToOpen!==!![]&&v(element);});}const stringMatch={};stringMatch[g(0x110)]=function(h,Q){return h===Q;},stringMatch[g(0x1bd)]=function(h,Q){const y8=g;return h[y8(0x1ca)](Q);},stringMatch[g(0x183)]=function(h,Q){return h['endsWith'](Q);},stringMatch['includes']=function(h,Q){return h['includes'](Q);},stringMatch['contains']=function(h,Q){const y9=g;return h[y9(0x1ae)](Q);},stringMatch['notexact']=function(h,Q){return h!==Q;},stringMatch[g(0x1a2)]=function(h,Q){const yy=g;return!h[yy(0x1ca)](Q);},stringMatch['notendswith']=function(h,Q){const yA=g;return!h[yA(0x1b7)](Q);},stringMatch['notincludes']=function(h,Q){const yh=g;return!h[yh(0x1ae)](Q);},stringMatch[g(0x1c6)]=function(h,Q){const yQ=g;return!h[yQ(0x1ae)](Q);},stringMatch[g(0x138)]=function(h,Q){const v=Q['match'](/\/(.+?)\/([a-z]*)$/);if(v){const Y=v[0x1],m=v[0x2],H=new RegExp(Y,m);return H['test'](h);}else{const u=new RegExp(Q);return u['test'](h);}};const copyToClipboard=h=>{const yv=g,Q=document[yv(0x14d)]('textarea');Q[yv(0x1b2)]=h,Q[yv(0x16e)](yv(0x1d1),''),Q[yv(0x1c7)]['position']='absolute',Q['style']['left']='-9999px',document[yv(0x149)][yv(0x191)](Q);const v=document[yv(0x11c)]()[yv(0x14f)]>0x0?document['getSelection']()[yv(0x16c)](0x0):![];Q['select'](),document[yv(0x136)](yv(0x1c9)),document[yv(0x149)][yv(0x19e)](Q),v&&(document[yv(0x11c)]()[yv(0x126)](),document[yv(0x11c)]()['addRange'](v));};function parametersProcess(){const yY=g;if(typeof element===yY(0x184)||element===null)throw new Error(yY(0x1bf));return_type=yY(0x1b8);typeof returnType!==yY(0x184)&&returnType!==null&&(return_type=returnType);return_variable_name=typeof DEFAULT_RETURN_VARIABLE_NAME===yY(0x184)?DEFAULT_RETURN_VARIABLE_NAME:yY(0x172);if(typeof returnVariableName!==yY(0x184)&&returnVariableName!==null)return_variable_name=returnVariableName;result_filter=yY(0x1cc);typeof resultsFilter!==yY(0x184)&&resultsFilter!==null&&(result_filter=resultsFilter);result_regex=null;typeof resultRegex!==yY(0x184)&&resultRegex!==null&&(result_regex=resultRegex);typeof highlightElements!==yY(0x184)&&highlightElements===!![]&&(highlight_elements=!![],highlight_grid=!![],highlight_headers=!![],highlight_rowgroup=!![],highlight_rows=!![],highlight_cells=!![],highlight_target_row=!![],highlight_target_cell=!![]);match_type=yY(0x110);typeof matchType!==yY(0x184)&&matchType!==null&&(match_type=matchType);if(typeof customListSelectors===yY(0x178))custom_list_selectors=customListSelectors;order_direction=yY(0x11d);typeof sortOrder!==yY(0x184)&&sortOrder!==null&&(order_direction=sortOrder['toUpperCase']());target_state;if(typeof checkState!==yY(0x184)){if(checkState==!![])target_state=yY(0x170);else{if(checkState==![])target_state=yY(0x1a5);else{if(checkState!==null)target_state=checkState;}}}typeof highlightElements!==yY(0x184)&&highlightElements===!![]&&(highlight_elements=!![],highlight_select_item=!![],highlight_groupbox=!![],highlight_selectlist=!![],highlight_selectlist_opener=!![]),verbose&&(console['info'](yY(0x1ce),return_type),console[yY(0x1c5)]('return_variable_name',return_variable_name),console[yY(0x1c5)](yY(0x11e),result_filter),console[yY(0x1c5)]('result_regex',result_regex),console[yY(0x1c5)]('match_type',match_type),console[yY(0x1c5)](yY(0x198),custom_list_selectors));}parametersProcess();

/*** END COMMON TABLE FUNCTIONALITY ***/

/*** Function Specific Logic Below ***/

return new Promise((resolve, reject) => {

    if (click_to_open === true) {
        return executeActionWithXPath({
            clickMethod: clickEventMethod, // Configurable click method
            targetSelector: element, // Configurable target element
            targetElementXPath: null, // XPath to the child checkbox within the item
            observerTarget: document.body, // Observe the whole document for new elements
            timeoutDuration: popup_timeout, // Configurable timeout duration
            useTimeout: true // Conditionally use timeout if event method is invoked
        })
            .then(result => {
                foundElement = select_list ?? result;
                console.log('New element detected:', foundElement);
                resolve(foundElement.select_list_instance ?? foundElement.select_list);  // Pass the found element to the next .then()
            })
    }
    else {
        resolve(element);
    }

})
    .then(foundElement => {

        results = selectListFind(foundElement);

        select_list = results?.select_list;
        select_list_tagname = results?.select_list_tagname;
        select_list_opener = results?.select_list_opener;
        select_listitem_groupbox = results?.select_listitem_groupbox;
        selected_item_indexes = [];
        unselected_item_indexes = null;

        var select_tags = ["select", "ol", "ul", "custom"];
        if (!select_tags.includes(select_list_tagname)) {
            throw new Error("Select Option(s) ==> Target element must be a select, ol, ul, option, li, or custom");
        }

        var actualValues = selectListItemsGet(select_list, return_type);

        var filteredValues = selectListItemsFilter(actualValues);

        copyToClipboard(JSON.stringify(filteredValues, null, 1));
        exportsTest[return_variable_name] = filteredValues;

        if (verbose) {
            console.log("===>", return_variable_name, JSON.stringify(exportsTest[return_variable_name]));
        }

    })
    .then(() => {

        /* Normalize items to select
         */
        var items_to_select = [];
        if (typeof itemId !== 'object')
            items_to_select.push(itemId);
        else
            items_to_select = itemId;

        /* Execute (Loops each item to select and selects/deselects as appropriate and if possible)
         */
        items_to_select.forEach(function (item_to_select) {
            if (select_listitem_groupbox !== undefined && select_listitem_groupbox !== null)
                selectItem(select_listitem_groupbox, item_to_select, select_list_tagname, match_type, target_state);
            else
                selectItem(select_list, item_to_select, select_list_tagname, match_type, target_state);

        });

    })
    .catch(error => {
        console.error('Error:', error);
    });
